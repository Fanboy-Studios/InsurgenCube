// check for an installed mappack
alias mappack_version 0; alias mappack_maps ""; alias mappack_flagmaps ""
exec config/menus_mappack.cfg

// standard menu definitions

newmenu main

menuitem (getlang m_multi)			"showmenu multiplayer"
menuitem (getlang m_single)			"showmenu singleplayer"
menuitem "Settings"					"showmenu settings"
menuitem (getlang m_demos)			[ showmenu "Play demo" ]
menuitem (getlang m_edit) 			"showmenu editing"
menuitem (getlang m_help)			"showmenu help"
menuitem (getlang m_about)			"showmenu about"
menuitem (getlang m_quit)				"savequit"


// Start maps.

alias genmapitems [
	alias n (listlen $arg1)
	loop i $n [
		alias listmapname (at $arg1 $i)
		menuitem $listmapname (concat map $listmapname)
		alias next (+ $i 1)
		if (= $next $n) [ alias next 0 ] []
		alias nextmap (at $arg1 $next)
		alias (concatword nextmap_ $listmapname) $nextmap
	]
]
newmenu maps
// Add maps to the below list to include them in the normal map menu (also for botmaps).
// Don't add ac_depot_classic to the maps list.
alias defaultmaps "ac_aqueous ac_arctic ac_complex ac_depot ac_depot_classic ac_desert ac_desert2 ac_desert3 ac_douze ac_elevation ac_gothic ac_iced ac_keller ac_mines ac_power ac_scaffold ac_shine ac_snow ac_sunset ac_toxic ac_twintowers ac_urban ac_wasteland"
genmapitems	$defaultmaps
menuitem	"" -1
if (&& $mappack_version (listlen $mappack_maps)) [menuitem (concatword "Map-pack (version " $mappack_version ") maps...") [showmenu "mappack maps"]];
menuitem	"Show all maps..." [ showmenu "all maps" ]

newmenu "all maps"
menudirlist "packages/maps" "cgz" "map $arg1"


newmenu maps_flags 
// Add maps to the below list to include them in the CTF, KTF & TKTF map menu. Maps should contain flags here.
alias ctfmaps "ac_aqueous ac_depot ac_desert ac_desert3 ac_douze ac_elevation ac_funhouse ac_gothic ac_iced ac_keller ac_mines ac_power ac_shine ac_sunset ac_twintowers ac_urban"
genmapitems $ctfmaps
menuitem "" -1
if (&& $mappack_version (listlen $mappack_flagmaps)) [menuitem (concatword "Map-pack (version " $mappack_version ") maps...") [showmenu "mappack flag maps"]];
menuitem "Show all maps.." [showmenu "all maps"]


if $mappack_version [
	newmenu "mappack maps"
	genmapitems $mappack_maps
	newmenu "mappack flag maps"
	genmapitems $mappack_flagmaps
]

newmenu Demo // If in-game (playing demos isn't needed)

menuitem (getlang m_d_record)	"recorddemo"
menuitem (getlang m_d_disable)	"stopdemolater"
menuitem (getlang m_d_stop)	"stopdemo"
menuitem (getlang m_d_get)	[ listdemos; showmenu "Download demo" ] // Lists the demos, then asks which would like to be downloaded.


newmenu "Download demo"
menuinit [ echo "4Choose the demo number you wish to download, as show below in the console." ]
menuitemtextinput "Demo number:  "	"" "alias dldemo $arg1"
menuitem "2		  [ Download ]		" "getdemo $dldemo"



newmenu "Play demo"	// If not in-game (recording/downloading demos isn't needed)
menuinit [ echo "To stop demo playback, type: 3/stopdemo" ]
menudirlist "demos/" "dmo" "demo $arg1"

// in-game menu that opens when pressing escape while watching a demo.
newmenu "Watching demo"
menuitem (getlang m_dw_stop) "stopdemo"
menuitem (getlang m_dw_restart) "demo $_demofile"
menuitem (getlang m_dw_other) [stopdemo; closemenu "Watching demo"; showmenu "Play demo"]
menuitem "" -1
menuitem "4Main menu..."		[ closemenu "Watching demo"; showmenu main ]
menuitem "3Quit AssaultCube Reloaded"		"savequit"

newmenu about

menuitem "AssaultCube Reloaded" -1
menuitem "					 ...Help"		"showmenu help"
menuitem "					 ...Credits"	"showmenu Credits"
if $mappack_version [ menuitem "					 ...Map-pack credits" [ showmenu "about mappack" ]];
menuitem "" -1
menuitem "by the 'AssaultCube Reloaded Task Force'" "showmenu Credits"
menuitem "5http://1a0c3r1.0victorz1.2ca5/" -1 // nice colors!
menuitem "5http://1team3.2acr3.0victorz1.2ca5/" -1 // nice colors!
menuitem "" -1
menuitem "AssaultCube Reloaded is a modification of AssaultCube" -1
menuitem "...by 'Rabid Viper Productions'." -1
menuitem "1http://assault.cubers.net/" -1
menuinitselection 2

newmenu help

menuitem (getlang m_h_ref) 		"showmenu reference"
menuitem (getlang m_h_sref) 	[ showmenu "Reference search" ]
menuitem (getlang m_h_kctl) 	"showmenu controls"
menuitem "" -1
menuitem (getlang m_h_foot) "echo 2The readme can be found in docs.zip under the base AssaultCube directory."

newmenu "Reference search"
menuinit [ alias docsearchstring "" ]
menuitemtextinput (getlang m_h_sref_for)	"" "alias docsearchstring $arg1"
menuitem "2		  [ Search ]			" "docfind $docsearchstring"


newmenu Credits

menuitem "AssaultCube Reloaded Credits" -1
menuitem "-----------------" -1
menuitem "Victor				Lead Programmer" -1
menuitem "AssaultCube				Codebase" -1
menuitem "" -1


// Show quit dialog if enabled
newmenu quit
menuitem (getlang m_q_y) "quit"
menuitem (getlang m_q_n) "showmenu "" "
menuitem "" -1
menuitemcheckbox (getlang m_q_a) "(= $askquit 0)" "askquit = (= $arg1 0)"

alias savequit [
	if (= $askquit 1) [ showmenu quit ] [ quit ]
]

// Create additional menus...
exec config/menus_bot.cfg
exec config/menus_edit.cfg
exec config/menus_settings.cfg
exec config/menus_multiplayer.cfg
exec config/menus_class_manager.cfg
exec config/favourites.cfg

